<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <title>üßø Amulet Admin Pro</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/static/admin.css">
  <style>
    body.bg-body { background: #f7fafc; color: #0b1021; }
    .app-title { letter-spacing: .2px; }
    .copyable { cursor: pointer; transition: background-color 0.2s; }
    .copyable:hover { background-color: #eff6ff; }
    .table-hover tbody tr:hover { background: #f3f6fb; }
    pre#apiResult { max-height: 300px; overflow: auto; }
  </style>
</head>
<body class="bg-body">
<div class="container py-4">
  <div class="d-flex align-items-center justify-content-between mb-3">
    <h3 class="app-title m-0">üßø Amulet Admin Pro</h3>
    <span class="badge rounded-pill text-bg-success">ADMIN PANEL</span>
  </div>

  <ul class="nav nav-tabs" id="adminTabs" role="tablist">
    <li class="nav-item"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#tabLicenses" type="button">Licenses</button></li>
    <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tabApiKeys" type="button">API Keys</button></li>
    <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tabVoices" type="button">Voices</button></li>
    <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tabLogs" type="button">Logs</button></li>
    <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tabConfig" type="button">Config</button></li>
    <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#tabConsole" type="button">API Console</button></li>
  </ul>

  <div class="tab-content pt-3">

    <!-- ===== LICENSES ===== -->
    <div class="tab-pane fade show active" id="tabLicenses">
      <div class="row g-3">
        <div class="col-lg-8">
          <div class="card mb-3">
            <div class="card-body">
              <h6 class="mb-3">–§—ñ–ª—å—Ç—Ä–∏ –ª—ñ—Ü–µ–Ω–∑—ñ–π</h6>
              <div class="row g-2">
                <div class="col-md-3"><input id="licSearch" class="form-control" placeholder="–ü–æ—à—É–∫ –ø–æ key –∞–±–æ mac_id"></div>
                <div class="col-md-2"><input id="licMinCredit" type="number" class="form-control" placeholder="–ú—ñ–Ω. –∫—Ä–µ–¥–∏—Ç"></div>
                <div class="col-md-2"><input id="licMaxCredit" type="number" class="form-control" placeholder="–ú–∞–∫—Å. –∫—Ä–µ–¥–∏—Ç"></div>
                <div class="col-md-2">
                  <select id="licActiveFilter" class="form-select">
                    <option value="">–£—Å—ñ —Å—Ç–∞—Ç—É—Å–∏</option>
                    <option value="true">–ê–∫—Ç–∏–≤–Ω—ñ</option>
                    <option value="false">–ù–µ–∞–∫—Ç–∏–≤–Ω—ñ</option>
                  </select>
                </div>
                <div class="col-md-2"><input id="licDateFrom" type="date" class="form-control"></div>
                <div class="col-md-2"><input id="licDateTo" type="date" class="form-control"></div>
                <div class="col-md-1"><button class="btn btn-outline-secondary" onclick="loadLicenses()">üîç</button></div>
              </div>
            </div>
          </div>
          <div class="table-responsive">
            <table class="table table-sm table-striped table-hover align-middle">
              <thead>
                <tr><th>ID</th><th>Key</th><th>MAC</th><th>Credit</th><th>Active</th><th>Created</th><th>Updated</th><th>–î—ñ—ó</th></tr>
              </thead>
              <tbody id="licTbody"></tbody>
            </table>
          </div>
        </div>
        <div class="col-lg-4">
          <div class="card mb-3">
            <div class="card-body">
              <h6 id="licFormTitle" class="mb-3">–î–æ–¥–∞—Ç–∏ –ª—ñ—Ü–µ–Ω–∑—ñ—é</h6>
              <input id="licId" type="hidden">
              <div class="mb-2"><label class="form-label">Key</label><input id="licKey" class="form-control"></div>
              <div class="mb-2"><label class="form-label">MAC (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)</label><input id="licMac" class="form-control"></div>
              <div class="mb-2"><label class="form-label">Credit</label><input id="licCredit" type="number" class="form-control" value="0"></div>
              <div class="form-check mb-2"><input id="licActive" class="form-check-input" type="checkbox" checked><label class="form-check-label">Active</label></div>
              <div class="d-flex gap-2 mb-2">
                <button class="btn btn-primary" onclick="submitLicense()">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏</button>
                <button class="btn btn-secondary" onclick="resetLicenseForm()">‚Ü∫ –û—á–∏—Å—Ç–∏—Ç–∏</button>
              </div>
              <hr>
              <div class="d-flex gap-2">
                <input id="licDelta" type="number" class="form-control" placeholder="Œî –±–∞–ª–∞–Ω—Å—É (–Ω–∞–ø—Ä. 100 –∞–±–æ -50)">
                <button class="btn btn-outline-primary" onclick="applyDelta()">‚ü≤ –ó–º—ñ–Ω–∏—Ç–∏ –±–∞–ª–∞–Ω—Å</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ===== API KEYS ===== -->
    <div class="tab-pane fade" id="tabApiKeys">
      <div class="row g-3">
        <div class="col-lg-8">
          <div class="table-responsive">
            <table class="table table-sm table-striped table-hover align-middle">
              <thead><tr><th>ID</th><th>API Key</th><th>Status</th><th>Created</th><th>–î—ñ—ó</th></tr></thead>
              <tbody id="akTbody"></tbody>
            </table>
          </div>
        </div>
        <div class="col-lg-4">
          <div class="card">
            <div class="card-body">
              <h6 id="akFormTitle" class="mb-3">–î–æ–¥–∞—Ç–∏ API Key</h6>
              <input id="akId" type="hidden">
              <div class="mb-2"><label class="form-label">API Key</label><input id="akKey" class="form-control"></div>
              <div class="mb-2"><label class="form-label">Status</label>
                <select id="akStatus" class="form-select"><option value="active">Active</option><option value="inactive">Inactive</option></select>
              </div>
              <div class="d-flex gap-2">
                <button class="btn btn-primary" onclick="submitApiKey()">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏</button>
                <button class="btn btn-secondary" onclick="resetApiKeyForm()">‚Ü∫ –û—á–∏—Å—Ç–∏—Ç–∏</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ===== VOICES ===== -->
    <div class="tab-pane fade" id="tabVoices">
      <div class="row g-3">
        <div class="col-lg-8">
          <div class="table-responsive">
            <table class="table table-sm table-striped table-hover align-middle">
              <thead><tr><th>ID</th><th>Name</th><th>Voice ID</th><th>Active</th><th>–î—ñ—ó</th></tr></thead>
              <tbody id="voicesTbody"></tbody>
            </table>
          </div>
        </div>
        <div class="col-lg-4">
          <div class="card mb-3">
            <div class="card-body">
              <h6 id="voiceFormTitle" class="mb-3">–î–æ–¥–∞—Ç–∏ –≥–æ–ª–æ—Å</h6>
              <input id="voiceId" type="hidden">
              <div class="mb-2"><label class="form-label">Name</label><input id="voiceName" class="form-control"></div>
              <div class="mb-2"><label class="form-label">Voice ID</label><input id="voiceVid" class="form-control"></div>
              <div class="form-check mb-2"><input id="voiceActive" class="form-check-input" type="checkbox" checked><label class="form-check-label">Active</label></div>
              <div class="d-flex gap-2">
                <button class="btn btn-primary" onclick="submitVoice()">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏</button>
                <button class="btn btn-secondary" onclick="resetVoiceForm()">‚Ü∫ –û—á–∏—Å—Ç–∏—Ç–∏</button>
              </div>
            </div>
          </div>
          <div class="card">
            <div class="card-body">
              <h6 class="mb-3">Upload –≥–æ–ª–æ—Å—ñ–≤ –∑ TXT (name:voice_id)</h6>
              <input id="voiceFile" type="file" class="form-control mb-2" accept=".txt">
              <button class="btn btn-outline-primary" onclick="uploadVoices()">üì§ Upload</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ===== LOGS ===== -->
    <div class="tab-pane fade" id="tabLogs">
      <div class="card mb-3">
        <div class="card-body">
          <h6 class="mb-3">–§—ñ–ª—å—Ç—Ä–∏ –ª–æ–≥—ñ–≤</h6>
          <div class="row g-2">
            <div class="col-md-3"><input id="logSearch" class="form-control" placeholder="–ü–æ—à—É–∫ –ø–æ detail"></div>
            <div class="col-md-2"><input id="logMinChars" type="number" class="form-control" placeholder="–ú—ñ–Ω. —Å–∏–º–≤–æ–ª–∏"></div>
            <div class="col-md-2"><input id="logMaxChars" type="number" class="form-control" placeholder="–ú–∞–∫—Å. —Å–∏–º–≤–æ–ª–∏"></div>
            <div class="col-md-2">
              <select id="logAction" class="form-select">
                <option value="">–£—Å—ñ –¥—ñ—ó</option>
                <option value="debit">Debit</option>
                <option value="refund">Refund</option>
                <option value="adjust_credit">Adjust Credit</option>
              </select>
            </div>
            <div class="col-md-2"><input id="logDateFrom" type="date" class="form-control"></div>
            <div class="col-md-2"><input id="logDateTo" type="date" class="form-control"></div>
            <div class="col-md-1"><button class="btn btn-outline-secondary" onclick="loadLogs()">üîç</button></div>
          </div>
        </div>
      </div>
      <div class="table-responsive">
        <table class="table table-sm table-striped table-hover align-middle">
          <thead><tr><th>ID</th><th>License ID</th><th>Action</th><th>Char Count</th><th>Details</th><th>Created</th></tr></thead>
          <tbody id="logsTbody"></tbody>
        </table>
      </div>
    </div>

    <!-- ===== CONFIG ===== -->
    <div class="tab-pane fade" id="tabConfig">
      <div class="row g-3">
        <div class="col-lg-8 col-xl-6">
          <div class="card">
            <div class="card-body">
              <h6 class="mb-3">–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è</h6>
              <div class="mb-2"><label class="form-label">latest_version</label><input id="cfgLatest" class="form-control"></div>
              <div class="form-check mb-2"><input id="cfgForce" class="form-check-input" type="checkbox"><label class="form-check-label">force_update</label></div>
              <div class="form-check mb-2"><input id="cfgMaint" class="form-check-input" type="checkbox"><label class="form-check-label">maintenance</label></div>
              <div class="mb-2"><label class="form-label">maintenance_message</label><textarea id="cfgMaintMsg" rows="2" class="form-control"></textarea></div>
              <div class="mb-2"><label class="form-label">update_description</label><textarea id="cfgDesc" rows="2" class="form-control"></textarea></div>
              <div class="mb-2"><label class="form-label">update_links (CSV –∞–±–æ JSON)</label><textarea id="cfgLinks" rows="2" class="form-control"></textarea></div>
              <div class="d-flex gap-2">
                <button class="btn btn-primary" onclick="saveConfig()">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏</button>
                <button class="btn btn-outline-success" onclick="downloadBackup()">üì• Full Backup</button>
                <button class="btn btn-outline-success" onclick="downloadLicensesBackup()">üì• Licenses Backup</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ===== API CONSOLE ===== -->
    <div class="tab-pane fade" id="tabConsole">
      <div class="card">
        <div class="card-body">
          <h6 class="mb-3">API Console (/api)</h6>
          <div class="row g-2 mb-2">
            <div class="col-md-3"><input id="apiAction" class="form-control" placeholder="action (check / debit / get_voices ...)"></div>
          </div>
          <textarea id="apiPayload" class="form-control mb-2" rows="4" placeholder='{"action":"check","key":"KEY-1","mac":"AA-BB"}'></textarea>
          <div class="d-flex gap-2 mb-2">
            <button class="btn btn-outline-primary" onclick="runConsole()">‚ñ∂ Run</button>
            <button class="btn btn-outline-secondary" onclick="formatJson()">{} Format JSON</button>
          </div>
          <pre id="apiResult" class="bg-dark text-success p-3 rounded small"></pre>
        </div>
      </div>
    </div>

  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="/static/admin.js"></script>
</body>
</html>